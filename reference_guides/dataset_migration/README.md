# Dataset Migration

The purpose of this guide is to give the user detailed step by step process for migrating datasets. Datasets can come in many different types, such as PDS, GDG, and VSAM, and the options needed for DSMIGIN will vary from dataset to dataset. By using this guide, you will know which options are needed for each dataset. 

# Table of Contents

- [The dsmigin Command](#1-the-dsmigin-command)
	- [General Usage](#11-general-usage)

# 1. The dsmigin Command

The dsmigin command is mainly used for converting EBCDIC mainframe datasets to ASCII OpenFrame datasets. Upon successful migration, the dataset will be catalogued. 

## 1.1 General Usage

```bash
dsmigin <src_file> <dest_file> [options]
```

| OPTIONS              | DESCRIPTION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| -C                   | Converts a file from EBCDIC to ASCII without importing the file into OpenFrame. The output file must be a general text file, not an OpenFrame dataset.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| -I                   | Imports a file directly into OpenFrame without conversion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -S                   | This option is used when the data given as the input file is a source code file. It sets the record format (RECFM) to L-type. L-type means Linux Delimited. An equivalent would be using "-f L" option                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| -m <member_name>     | Specifies the member name (for a PDS) or the relative generation number (for a GDG) of the dataset to be created.<br> <br> - Specify only the <dataset_name> when creating an SDS (Sequential Dataset)<br> <br> - Specify both the <dataset_name> and <member_name> when creating a PDS (Partitioned Dataset)<br> <br> - Set the <dataset_name> and specify a generation number (+1,+2,...) as the <member_name> when creating a GDS (Generation Dataset). To reregister an existing GDS with the -R option, the generation number should be specified as a negative number or 0.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -u <unit>            | Specifies the UNIT group name where the dataset will be created.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -v <volume>          | Specifies the volume where the dataset will be created<br> <br> If left unspecified, the dataset will be created in the volume listed in the DEFAULT_VOLSER variable in the [DATASET_DEFAULT] section of the ds.conf configuration file. (If the -F option is specified but the -v option is not, the volume can be determined according to the catalog when a dataset is already registered in a catalog)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -c <user_catalog>    | Specifies the catalog where the dataset will be registered.<br> <br> If not specified, the dataset is registered in a master catalog or user's catalog whose name is identical to the qualified entry name by alias setting.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -e <encoding_code>   | Specifies to what ASCII characters the EBCDIC two-byte data should be converted.<br> <br> By an encoding_code value, EBCDIC data is converted as follows:<br> <br> - US: English (Default)<br> <br> - KR: Korean (EUC-KR)<br> <br> - JP: Japanese (Shift-JIS)<br> <br> - JAK: Japanese (JEF - Fujitsu Mainframe)<br> <br> - KEIS: Japanese (Hitachi Mainframe)<br> <br> User-created encoding_codes can be defined, see note below.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| -s <schema>          | Specifies the schema file to be used. If multiple character sets are used within the same record in the UNIX source file (e.g. if EBCDIC and ASCII codes are mixed together, or two-byte characters, packed decimal, and zoned decimal are used) simple code conversion is impossible. In this case, a schema file should be created with cobgensch or pligensch and specified here. If no filename is specified, a schema file that matches the source file name will be chosen from the directory specified by the SCHEMA_DIR variable in the [DATASET_DIRECTORY] section of ds.conf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| -t                   | Specifies the CUSTOM file that contains the list of codes to be converted from EBCDIC fullwidth characters to ASCII halfwidth caracters. If not specified, EBCDIC fullwidth characters will be converted to ASCII fullwidth characters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| -cob <cobol_type>    | Specifies the type of COBOL language used<br> <br> - MF (MicroFocus COBOL)<br> <br> - NET (Net COBOL)<br> <br> If unspecified, the value that is specified in COBOL_COMPILER within the [COMPILER] section of ofsys.conf is used. If COBOL_COMPILER is not specified in the ofsys.conf file, the default MF, is used.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -map                 | Deletes parent key data Used to convert the BMS map. If a two-byte string surrounded by SO and SI is too long, and is divided into two different lines: a line including SO and the other line including SI, this option enables such strings to be recognized. This option will be ignored, unless it used with the -S option.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| -k <keylen>          | Specifies the key length; used for ISAM datasets with the DSORG specified as IS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -p <keypos>          | Specifies the key position; used for ISAM datasets with the DSORG specified as IS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| -l <lrecl>           | Specifies the record length (LRECL) of a dataset. For fixed length records, the actual record length of a dataset is checked against the specified length. For variable-length records, the maximum record length is specified. If no record length is specified, the record length specified in the schema file is used by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -o <dsorg>           | Specifies the DSORG of the dataset to be created.<br> <br> DSORG can contain one of the following values: <br> <br> - PS (Physical Sequential) (DEFAULT)<br> <br> - PO (Partitioned Organization)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -b <blksize>         | Specifies the block size (BLKSIZE) of the dataset                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -f <recfm>           | Specifies the record format (RECFM) of the dataset.<br> <br> The record format can be one of the following:<br> <br> - F (Fixed)<br> <br> - FB (Fixed Block)<br> <br> - V (Variable)<br> <br> - VB (Variable Block)<br> <br> - L (Line)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| -d <delimiter>       | Specifies the delimiter that separates records in the UNIX source file. To use the newline or tab characters, specify "\n" or "\t" respectively.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -i                   | Used to process migration while ignoring records that fail to be converted during the migration. Information about such records is output to the standard output stream (stdout). When the program is terminated, the number of failed records is displayed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -w <lockwait>        | If the dataset to be imported is locked, dsmigin waits until the lock is lifted and then completes the task. If this option is unspecified and the dataset to be imported is locked, an error message will be displayed and the job will be stopped.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -n                   | If a file is converted without being imported into OpenFrame, this option attaches a newline character to each record as a delimiter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -y                   | Checks the conditional statements of a schema during migration and selects migration targets. If not specified, targets must be selected for each record before starting the migration. If specified, the -D option must be specified when creating the schema file using cobgensch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -a                   | Used to process the 7th and 8th types of SOSI if an ASA control character is included in the first column of each record.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -sosi <sosi_type>    | When two-byte characters are used within a record field, a SOSI character is used to differentiate them from one-byte characters.<br> <br> [SOSI TYPES]<br> <br> - 1 = so[EBC]si --> so[ASC]si<br> <br> Does not convert SOSI (DEFAULT)<br> <br> - 2 = so[EBC]si --> _[ASC]_<br> <br> Converts SOSI to space<br> <br> - 3 = so[EBC]si --> [ASC]<br> <br> Deletes a SOSI and fills the deleted SOSI area in the right side of the field to convert with space characters.<br> <br> - 4 = so[JEF]si --> so[ASC]si<br> <br> Converts JEF SOSI to ASCII SOSI<br> <br> - 5 = BMS map conversion<br> <br> Converts non-mapped characters into '0x2E' instead of '0x00'. This option is useful when migrating BMS maps. It is used when a two-byte character without SOSI is displayed as a value of the original BMS map INITIAL statement.<br> Note: When migrating the BMS map, the miscadjust tool, used after dsmigin, may abnormally operate if '0x00' is included within a result file, and so this option can be used to enable the mscadjust tool to normally work for the file.<br> <br> - 6 = No SOSI conversion<br> <br> Considers data as a one-byte character regardless of the existance of SOSI values, and converts it.<br> <br> - 7 = so[EBC]si --> [ASC]_<br> <br> Deletes SOSI. Fills the deleted SOSI area in front of the column 72 with space characters. Like a COBOL application, columns from 72, a comment area, are used for resource migration.<br> <br> - 8 = so[EBC]si --> _[ASC]<br> <br> Deletes SOSI and fills the deleted SOSI area in the back of column 7 with space characters. Like a COBOL application, columns 1 to 7, which area comment areas, are used for resource migration.<br> <br> - 9 = so[EBC]si --> ?[ASC]?<br> <br> Converts SOSI characters using SOSI characters registered in CPM. |
| -psmsb               | For EBCDIC to ASCII conversion, changes the sign bit of a packed decimal from the least significant byte (LSB) to the most significant byte (MSB)<br> <br> - usigned: replaces the F in the last 4 bits to a zero in the MSB<br> <br> - signed: replaces the C in the last 4 bits to a zero in the MSB, and D in the last 4 bits to a oen in the MSB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -d <error_detection> | For EBCDIC to ASCII conversion, detects conversion error in (un)signed packed/zoned decimal type fields with only Low (0x00), High (0xFF), and Space (0x40) characters. This option cannot be used in conjunction with -z option and -i option takes precedence over this option.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -z <zero>            | For EBCDIC to ASCII conversion, converts (un)signed packed/zoned decimal type field values with only Low (0x00), High (0xFF), and Space (0x40) characters into a zero (0x30). This option cannot be used in conjunction with -ed option                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| -N                   | The dataset will not be registered to the catalog during migration. If the specified dataset name is already registered in the catalog, the catalog item will not be updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -R                   | Re-catalogs a dataset that is registered to the catalog. If this option is set, the unit (-u) and volume (-v) parameters will be ignored. The registration information of the dataset within the catalog is searched and the dataset will be imported to the volume. Registration information such as the unit and volume will be kept, but other DCB information will be renewed.<br> <br> If this option is not specified and the dataset to be imported is already registered in the catalog, an error message will be displayed and the job will be stopped.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -F                   | If the dataset is already registered in the catalog, the existing dataset and catalog item will be deleted, data will be re-imported, and the dataset will be re-registered. As the result existing registration information (such as the unit, volume, and creation date) will be overwritten. If the [-N] option is specified, the cataloged item will not be processed.<br> <br> If this option is not specified and the dataset to be imported is already registered in the catalog, an error message will be displayed and the job will be stopped.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| -D                   | Displays detailed information about the EBCDIC to ASCII conversion and abnormal data that is found during the PACKED DECIMAL or ZONED DECIMAL field value conversion. Also shows debugging information useful to analyze migration issues.  A value between 1 and 3 can be specified:<br> <br> - 1: Displays some important information while performing migration<br> <br> - 2: In addition to 1, displays error information that occurs when converting codes.<br> <br> - 3: In addition to 2, displays data before and after record conversion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -V                   | Displays version information about dsmigin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

# Flat Files (PS)

#TODO 